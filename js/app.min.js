"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_createClass=function(){function a(b,c){for(var f,d=0;d<c.length;d++)f=c[d],f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(b,f.key,f)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&("object"===("undefined"==typeof b?"undefined":_typeof(b))||"function"==typeof b)?b:a}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof b?"undefined":_typeof(b)));a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var Entity=function(){function a(b,c,d,f,g,h){_classCallCheck(this,a),this.sprite=b,this.x=c,this.y=d,this.width=f,this.height=g,this.speed=h}return _createClass(a,[{key:"render",value:function(){ctx.drawImage(Resources.get(this.sprite),this.x,this.y)}},{key:"checkCollision",value:function(){var c=!1;return this.x+this.width>player.x&&player.x+player.width>this.x&&player.y+player.height>this.y&&this.y+this.height>player.y&&(c=!0),c}},{key:"holdIt",value:function(){var c=this.speed;return this.speed=0,c}},{key:"restart",value:function(c){this.speed=c}}]),a}(),Enemy=function(a){function b(c,d,f,g,h,j,k){_classCallCheck(this,b);var l=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c,d,f,g,h,j));return l.rules=k,l}return _inherits(b,a),_createClass(b,[{key:"update",value:function(d){505>this.x?this.x+=this.speed*d:this.setStats(),this.doCollision(this.checkCollision())}},{key:"doCollision",value:function(d){!0===d&&player.loseLife()}},{key:"setSize",value:function(d){var f={regular:{sprite:"images/enemy-bug.png",width:75,height:55},toxic:{sprite:"images/enemy-toxic.png",width:80,height:75}};Math.floor(10*Math.random()+1)>d?(this.sprite=f.regular.sprite,this.width=f.regular.width,this.height=f.regular.height):(this.sprite=f.toxic.sprite,this.width=f.toxic.width,this.height=f.toxic.height)}},{key:"setX",value:function(){var d={a:-100,b:-225,c:-350},f=Math.floor(100*Math.random())+1;1<=f&&40>f&&(this.x=d.a),40<=f&&75>f&&(this.x=d.b),75<=f&&101>f&&(this.x=d.c)}},{key:"setSpeed",value:function(d,f){this.speed=Math.floor(Math.random()*d)+f}},{key:"setStats",value:function(){this.setSize(10*this.rules.toxicChance),this.setX(),this.setSpeed(this.rules.speed.high,this.rules.speed.low)}}]),b}(Entity),Player=function(a){function b(c,d,f,g,h,j,k,l){_classCallCheck(this,b);var m=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,c,d,f,g,h,j));return m.lives=k,m.level=l,m}return _inherits(b,a),_createClass(b,[{key:"handleInput",value:function(d){if("left"==d)-15<this.x-this.speed&&(this.x-=1.25*this.speed);else if("right"==d)420>this.x+this.speed&&(this.x+=1.25*this.speed);else if("up"!=d)"down"==d&&(400>this.y+this.speed?this.y+=this.speed:this.y=400);else if(-10<this.y-this.speed)this.y-=this.speed;else{if(-10.1==this.y)return;this.y=-10}}},{key:"update",value:function(){-10==this.y&&this.winLevel()}},{key:"loseLife",value:function(){this.resetPlayer(),1<this.lives?(this.lives--,setLives()):(this.y=-10.1,pauseGame("loseGame"))}},{key:"winLevel",value:function(){this.y=-10.1,4>=player.level?pauseGame("winLevel"):pauseGame("winGame")}},{key:"resetPlayer",value:function(){var d=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;this.x=playerStart.x,this.y=playerStart.y,this.speed=playerStart.speed,d&&(this.level=1,this.lives=3,setLives())}}]),b}(Entity),playerStart={x:200,y:400,speed:82},newPlayer=new Player("images/char-boy.png",playerStart.x,playerStart.y,60,70,playerStart.speed,3,1),player=newPlayer,allEnemies;function setLevel(){var a=player.level,b=document.getElementById("levelMarker");b.innerHTML=a;var c;1===a?c={speed:{high:200,low:100},toxicChance:0}:2===a?c={speed:{high:280,low:130},toxicChance:0.1}:3===a?c={speed:{high:300,low:160},toxicChance:0.2}:4===a?c={speed:{high:340,low:200},toxicChance:0.3}:5===a&&(c={speed:{high:400,low:250},toxicChance:0.4}),setEnemies(c)}setLevel();function setEnemies(a){var b={top:65,middle:148,bottom:230},c=new Enemy(null,null,b.top,null,null,null,a),d=new Enemy(null,null,b.middle,null,null,null,a),f=new Enemy(null,null,b.bottom,null,null,null,a);allEnemies=[c,d,f];var g=!0,h=!1,j;try{for(var l,m,k=allEnemies[Symbol.iterator]();!(g=(l=k.next()).done);g=!0)m=l.value,m.setStats()}catch(n){h=!0,j=n}finally{try{!g&&k.return&&k.return()}finally{if(h)throw j}}}var pauseState=0;function pauseGame(a){var b=allEnemies[0].holdIt(),c=allEnemies[1].holdIt(),d=allEnemies[2].holdIt(),f=player.holdIt(),g=document.getElementById(a);g.classList.remove("hidden");var h=g.cloneNode(!0);g.parentNode.replaceChild(h,g),g=document.getElementById(a),g.classList.add("visible"),"userPause"==a?pauseState=[b,c,d,f]:("winLevel"==a||"winGame"==a||"loseGame"==a)&&(pauseState=a)}function resumeGame(a){allEnemies[0].speed=pauseState[0],allEnemies[1].speed=pauseState[1],allEnemies[2].speed=pauseState[2],player.speed=pauseState[3];var b;"userResume"==a?(pauseState=0,b="userPause"):"newLevel"==a?(b="winLevel",player.level++,player.resetPlayer(),setLevel()):("winGame"==a||"loseGame"==a)&&(b=a,player.resetPlayer("newGame"),setLevel());var c=document.getElementById(b);c.classList.remove("visible");var d=c.cloneNode(!0);c.parentNode.replaceChild(d,c),c=document.getElementById(b),c.classList.add("hidden")}function setLives(){for(var a=document.getElementById("livesList"),c="",d=player.lives;0<d;d--)c+="<li class=\"life\"></li>";a.innerHTML=c}setLives(),document.addEventListener("keyup",function(a){" "==a.key||"spacebar"==a.key?0===pauseState?pauseGame("userPause"):"winLevel"===pauseState?(resumeGame("newLevel"),pauseState=0):"winGame"===pauseState||"loseGame"===pauseState?resumeGame(pauseState):resumeGame("userResume"):player.handleInput({ArrowLeft:"left",a:"left",ArrowUp:"up",w:"up",ArrowRight:"right",d:"right",ArrowDown:"down",s:"down"}[a.key])});
